<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.ssafy.travelog.model.mapper.PostMapper">

    <insert id="insertPost" parameterType="PostDto" useGeneratedKeys="true" keyProperty="id">
        INSERT INTO Posts (user_id, image_url, travel_location, caption)
        VALUES (#{userId}, #{imageUrl}, #{travelLocation}, #{caption})
    </insert>

    <select id="selectAllPosts" resultType="PostDto">
        SELECT p.*, u.nickname AS userNickname, u.profile_image AS userProfileImage
        FROM Posts p
                 JOIN Users u ON p.user_id = u.id
        ORDER BY p.created_at DESC
    </select>

    <select id="selectPostsByUserId" parameterType="int" resultType="PostDto">
        SELECT * FROM Posts
        WHERE user_id = #{userId}
        ORDER BY created_at DESC
    </select>

</mapper>